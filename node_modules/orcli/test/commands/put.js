var put = require('../../lib-cov/commands/put');
var nock = require('nock');
var OIO_URL = 'https://api.orchestrate.io';
var assert = require('assert');

describe('put', function () {
  afterEach(function () {
    nock.cleanAll();
  });

  it('should create an object', function (done) {
    var scope = nock(OIO_URL)
    .put('/v0/users/garbados')
    .reply(201);

    put(['users', 'garbados'], {
      is_a_babe: true
    })
    .then(function () {
      assert(scope.isDone());
      done();
    })
    .fail(done);
  });

  it('should create an object with if-match', function (done) {
    var scope = nock(OIO_URL)
    .put('/v0/users/garbados')
    .reply(201);

    put(['users', 'garbados'], {
      is_a_babe: true,
      "if-match": 'kfajhewlfahwef'
    })
    .then(function () {
      assert(scope.isDone());
      done();
    })
    .fail(done);
  });

  it('should update an object with if-none-match', function (done) {
    var scope = nock(OIO_URL)
    .put('/v0/users/garbados')
    .reply(201);

    put(['users', 'garbados'], {
      is_a_babe: true,
      "if-none-match": true
    })
    .then(function () {
      assert(scope.isDone());
      done();
    })
    .fail(done);
  });
});
