var common = require('../../lib-cov/common');
var rm = require('../../lib-cov/commands/rm');
var assert = require('assert');

describe('rm', function () {

  before(function () {
    this.original_config = common.get_config();
    common.put_config({
      keys: { jellykid: 'exists' }
    });
  });

  after(function () {
    common.put_config(this.original_config);
  });

  it('should remove a given key', function (done) {
    rm(['jellykid'])
    .then(function (text) {
      assert(text === "Key jellykid removed.");
      done();
    })
    .fail(done);
  });

  it('should remove all keys', function (done) {
    rm(['*'])
    .then(function (text) {
      assert(text === "All keys removed.");
      done();
    })
    .fail(done);
  });

  it('should not remove keys it can\'t find', function (done) {
    rm(['jellybutts'])
    .fail(function (err) {
      assert(err.message === "Key jellybutts could not be removed because it was not found.");
      done();
    });
  });
});
