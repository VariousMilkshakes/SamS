var kew = require('kew');
var concat = require('concat-stream');

function get_stdin (stream) {
  var defer = kew.defer();
  var stdin;

  // return null if no stdin is passed
  if (stream.isTTY) {
    defer.resolve(null);
  } else {
    stream.setEncoding('utf8');
    stream
    .pipe(concat(function (input) {
      defer.resolve(input);
    }))
    .on('error', function (err) {
      defer.reject(err);
    }); 
  }

  return defer.promise;
}

exports.get = get_stdin;
