// N.B. each command returns a promise
// find its function in the file of the same name
var kew = require('kew');
var COMMANDS = {
  use: require('./use'),
  ls: require('./ls'),
  rm: require('./rm'),
  get: require('./get'),
  post: require('./post'),
  put: require('./put'),
  del: require('./delete'),
  delete: require('./delete'),
  patch: require('./patch'),
  merge: require('./merge'),
  search: require('./search'),
  graph: require('./graph'),
  event: require('./event'),
  refs: require('./refs')
};

function Commander (args, kwargs) {
  var command = args[0];
  var cmd_args = args.slice(1);

  var func = COMMANDS[command];
  if (!func) 
    return kew.reject(command + ' is not a recognized command.');
  else {
    try {
      return func.call(this, cmd_args, kwargs);
    } catch (e) {
      return kew.reject(e);
    }
  }
}

Commander.commands = COMMANDS;
module.exports = Commander;
