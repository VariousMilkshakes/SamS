var common = require('../common');
var orchestrate = require('orchestrate');
var kew = require('kew');

var USAGE = "orcli merge [collection] [key]";

module.exports = function (args, kwargs) {
  var db = common.get_db(this.api_key);

  if (args.length !== 2) throw new Error(USAGE);

  var collection = args[0];
  var key = args[1];
  var if_match = kwargs['if-match'];
  if (kwargs['if-match']) delete kwargs['if-match'];

  return db.merge(collection, key, kwargs, if_match);
};
