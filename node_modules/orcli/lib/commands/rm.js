var common = require('../common');
var kew = require('kew');

var USAGE = "orcli rm [name]";

module.exports = function (args, opts) {
  var name = args[0];
  if (!name) throw new Error(USAGE);
  var config = common.get_config();
  var msg;

  if (name === '*') {
    config.keys = {};
    msg = "All keys removed.";
  } else if (name in config.keys) {
    delete config.keys[name];
    msg = "Key " + name + " removed.";
  }

  if (msg) {
    common.put_config(config);
    return kew.resolve(msg); 
  } else {
    return kew.reject(new Error("Key " + name + " could not be removed because it was not found."));
  }
};
